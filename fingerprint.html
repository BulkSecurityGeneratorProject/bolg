<html>
    <head>
        <meta charset="utf-8">
        <title>指纹数据</title>    
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta http-equiv="Access-Control-Allow-Origin" content="*">
        <style type="text/css">
            #content {margin: 50px;}
            .bold{font-weight: bold;}
        </style>
        
    </head>
    <body >
        <div id="content">
            
        </div>
        <!-- <script src="fingerPrintJs/frms-fingerprint-origin.js"></script> -->
        <!-- <script src="fingerPrintJs/frms-finger-origin-min.js"></script> -->
        <script src="https://service.udcredit.com:10000/sdk/device-fingerprint/web?partnerCode=1000000000TEST&appKey=9cWbNgUqiL91raHPVmrP"></script>
        <script type="text/JavaScript"> 
            (function() {
                var _UDCREDIT_TRACEID = "";
                var _UDCREDIT_DEVICEID = "";
                var tmpCount = 10;//定时器 0.5秒启动一次，做多尝试10次
      
        
                var onloadFunction = function(){
                    if(document.cookie){
                        fillData(document.cookie);
                        var str = "UDCREDIT_TRACEID : " + _UDCREDIT_TRACEID + "</br>" +
                            "UDCREDIT_DEVICEID : "+_UDCREDIT_DEVICEID
          var info ="正在获取设备指纹";
          if(_UDCREDIT_TRACEID!=""&&_UDCREDIT_DEVICEID!=""){
            document.getElementById("content").innerHTML=str;
            if(tmpCount-- >0){
             setTimeout(getInfo,100);
          } 
          }else{
             document.getElementById("content").innerHTML=info;
             setTimeout(onloadFunction,100);
            }
                       
                    }else{
            setTimeout(onloadFunction,100);
          }
                }
                window.onload =onloadFunction;

                var fillData = function (str){
                    var _list  = (str + "").split(" ").join("").split(";");
                    for(var i=0;i<_list.length;i++){
                        var _listSplit=_list[i].split("=");
                        if(_listSplit.length==2){
                            if(_listSplit[0]=="UDCREDIT_TRACEID"){
                                _UDCREDIT_TRACEID = _listSplit[1];
                            }else if(_listSplit[0]=="UDCREDIT_DEVICEID"){
                                _UDCREDIT_DEVICEID = _listSplit[1];
                            }
                        } 
                    }
                    return false;
                }
                var getInfo = function (){
                    var _URL = "https://service.udcredit.com:10000/api/device-fingerprint?platform=2&traceid="+_UDCREDIT_TRACEID;
                    var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance
                  var isIE = getBrowserVersion();
                    if(isIE=="IE7"||isIE=="IE8"){
            xmlhttp = new ActiveXObject("microsoft.XMLHTTP");
          }
                    xmlhttp.onreadystatechange=state_Change;
                    xmlhttp.open("GET",_URL,true);
                    xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                    xmlhttp.send(null);
                    function state_Change(){                       
                        if(xmlhttp.readyState==4){
                            if (xmlhttp.status==200){
                                if(xmlhttp.responseText){
                                    var json =JSON.parse(xmlhttp.responseText);
                                    document.getElementById("content").innerHTML = 
                                        document.getElementById("content").innerHTML+"</br>"+
                                        "</br>info : "+JSON.stringify(json)
                                }
                                
                            }else if(xmlhttp.status==401){
                                
                            }
                        }
                    }
                }
                var getBrowserVersion = function(){     
            var userAgent = navigator.userAgent.toLowerCase();   
            if(userAgent.match(/msie ([\d.]+)/)!=null){
              uaMatch = userAgent.match(/msie ([\d.]+)/);               
              return 'IE'+parseInt(uaMatch[1]);        
            }else if(userAgent.match(/(trident)\/([\w.]+)/)){
                uaMatch = userAgent.match(/trident\/([\w.]+)/);
                switch (uaMatch[1]){
              case "4.0": return "IE8" ;break; 
              case "5.0": return "IE9" ;break; 
              case "6.0": return "IE10";break;
              case "7.0": return "IE11";break;                                
              default:return "undefined" ;            
                        }  
                  }       
            return "undefined";  
          }
            })()
        </script>
    </body>
</html>
